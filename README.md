## Superuser

Admin
admin@example.com
pass123word

ORM - object relational mapper (объектно реляционный преобразователь)
QuerySet - набор запросов

get() - только один объект

* DoesNotExist - объектов не найдено
* MultipleObjectReturned - более одного объекта

Создание объектов:
post.save() = SQL `INSERT`
или одной командой .create()

Обновление объектов:
`... вносимые действия в объект ...`
post.save() = SQL `UPDATE`

.objects - модельный менеджер
.filter(одно или несколько полей)
.exclude() - исключение из запроса
.order_by(поле) - упорядочение (возрастающий, если - дефис, то убывающий)

Когда вызывается ленивый QuerySet (превращается в SQL запрос)?

- При первой итерации в цикле
- При нарезке (`Post.objects.all()[:3]`)
- При консервации в поток байтов или кэшировании
- при вызове repr(), len()
- list() (в явной форме)
- проверка bool(), or, and, if

### Создание модельных менеджеров

* Добавлять методы в существующий `Post.objects.my_manager()`
* Создавать новый менеждер `Post.my_manager.all()`

### Templates

* `{% tag %}` - шаблонный тег (отвечает за прорисовку)
* `{{ variable }}` - шаблонная переменная (заменяется значением)
* `{{ variable|filter }}` - шаблонный фильтр (видоизменение отображаемых переменных)

Примеры тегов:

* load static - загружает статик, дальше можно обращатся через блок static
* block - блок, который нужно заполнить (можно путем наследования блоком extends)

Шаблонные фильтры (можно использовать в связке):

* truncatewords - усечь по кол-ву слов
* linebreaks - конвертирует разрывы строк в формат HTML

## Часть 2

* Канонический адрес модели
* Дружественные для поисковой оптимизации URL адреса: `blog/2022/1/1/slug/` - поисковые механизмы
* Постраничная разбивка

### Представления на основе классов

Преимущество перед функциями:

* Не организовывать ветвления условия (для GET, POST, DELETE)
* Множественное наследование, для реиспользуемости

### Формы отправки постов друзьям по email

Базовые классы для разработки форм:

* Form - компоновка стандартных форм (определение полей и их валидации)
* ModelForm - компоновка форм, привязанных к модели. Создание/редактирование экземпляра модели
    * `fields = [...]` то что включить
    * `exclude = [...]` то что исключить

SMTP сервер - Simple Mail Transport Protocol.
Конфигурация:

* EMAIL_HOST - хост (localserver по умолчанию)
* EMAIL_PORT - default 25
* EMAIL_HOST_USER - пользовательское имя для SMTP
* EMAIL_HOST_PASSWORD - пользовательское имя для SMTP
* EMAIL_USE_TLS -
* EMAIL_USE_SSL

Шаблонный тег csrf_token генерирует скрытое поле
`<input type='hidden' name='csrfmiddlewaretoken' value='26JjKo2lcEtYkGoV9z4XmJIEHLXN5LDR' />`

Большинство современных браузеров делает проверку форм самостоятельно
Чтобы отключить ее и проверить собственную, нужно добавить `<form ... novalidate>`

### Comments

Шаблонный тег `{% with %}` - полезен в сохранении результата функции (дорогостоящего, как вызов в дб)
в переменную для последующего многократного использования

Шаблонный фильтр pluralize - 0 или 1 => '', >1 => 's'

Шаблонный тег `{% for %} {% emptry %} {% endfor %}`

## Часть 3

### Тэгирование

django-taggit - модель Tag
Содержит:

- name
- slug

1:N -> TaggedItem:

* id
* tag
* content_type (fk)
* object_od (int)
  2-последних реализуют обобщенное отношение с любой моделью

`|join:', '` - синтаксис фильтра с параметрами

### Создание свои шаблонных тегов

* simple_tag - обрабатывает предоставленные данные, возвращает строку
* inclusion_tag - обрабатывает предоставленные данные, возвращает прорисованный шаблон

`func as name` - сохранение в переменную

### Шаблонные фильтры

`{{ variable|my_filter }}`
`{{ variable|my_filter:"foo" }}` - с аргументами
`{{ value|capfirst }}` - приведение первого символа в верхний регистр
`{{ value|filter_1|filter_2}}` - цепочка фильтров

### Добавление карты сайта

Карта сайта – это XML-файл, который сообщает поисковым системам о страницах веб-сайта,
их релевантность и частоту их обновления
Использование карты сделает сайт более заметным в рейтинге поисковых систем,
поскольку она помогает поисковым роботам индексировать содержимое сайта.

Фреймворк `django.contrib.sites` - ассоциация объектов с сайтами, управление несколькими сайтами используя один проект

### Создание новостных лент

Встроенный фреймворк для генерации новостных лент (RSS, Atom)
Новостная лента - формат данных (обычно XML), который предоставляет пользователям самый последний обновленный контент
Пользователи подписываются на новостную ленту с помощью агрегатора новостных лент
_(ПО для чтения новостных лент и получение уведомлений о новом контенте)_

### Полнотекстовой поиск

встроенный ORM преобразователь
`Post.objects.filter(body__contains='framework')` или icontains - нечувствительная к регистру

Полнотекстовой механизм позволяет выполнять более сложные запросы, взвешивание по количеству и степени важности полей

PostgreSQL и модуль `django.contrib.postgres` предоставляет отдельную функциональность поиска, отличную от общей

superuser password:
r0otu8er

user: blog
password: blogblog

Фикстуры - способ загрузки и выгрузки данных (JSON, XML, YAML)

dumpdata -> JSON
app.Model - отдельные модели
--format
--output - указать вывод
--indent - отступ

### Поиск
`Post.objects.filter(title__search='One')` - по одному полю
`Post.objects.annotate(search=Search('title', 'body')).filter(search='django')` - по нескольким полям
Иногда стоит определить `SearchVectorField`

SearchQuery
- Стемминг - выделение основ слов (music = musically = musicality)
- Удаление стоп слов (a, for, of, on, the)

SearchRank - ранжирование запросов на основании частоты появления терминов 

На других языках - используем config

Взвешевание:
`SearchVector('title', weight='A') + SearchVector('body', weight='B')`
D, C, B, A = 0.1, 0.2, 0.4, 1.0

#### Триаграммы
группа из трех следующих друг за другом символов
Расширение в postgre: 